<html>
	<head>
		<title>Sample Page | UX capture</title>

		<!-- don't do this in production, but inline it instead -->
		<script src="../lib/ux-capture.min.js"></script>

		<script>
			// sample custom reporter function for collected measures
			const customMeasureRecordingFunction = name => {
				// there can be multiple entries with the same name, get the latest
				const measure = performance
					.getEntriesByType('measure')
					.filter(entry => entry.name === name)
					.pop();

				if (typeof measure.duration !== 'undefined') {
					// in real world you might be sending this to your custom monitoring solution
					// (because it does not support W3C UserTiming API natively)
					console.log('Measure', name, ':', measure.duration);
				}
			};

			window.UXCapture.create({
				onMeasure: customMeasureRecordingFunction,
			});

			/**
			 * Array of zone objects groupping elements together
			 *
			 * window.UXCapture.startView([
			 * {
			 *  name: "ux-destination-verified",
			 *  elements: ...
			 * }
			 * ]);
			 *
			 * Using elements array with elementSelector and optional expectedElements properties
			 * will allow you to automatically detect already rendered elements and zones during startView() call
			 * in interactive views.
			 *
			 * Each element is marked using UserTiming and selectors
			 * elements: [{
			 *  // [<string>] - names of marks to expect for this element
			 *  marks: ["ux-image-logo-onload", "ux-image-logo-inline"],
			 *
			 *  // <string|function> - string is an input to document.querySelectorAll()
			 *  //                     or function that returns a collection of DOM nodes.
			 *  // Used to detect if elements are already on the page on SPA transition
			 *  // and for highlighting during debugging
			 *  elementSelector: "h1",
			 *
			 *  // <number|function> - number is used to compare to return of elementSelector
			 *  //                     or function that returns a boolean indicating if element
			 *  //                     is already displayed and functional
			 *  // default: 1
			 *  expectedElements: 2
			 * }]
			 */
			window.UXCapture.startView([
				{
					name: 'ux-destination-verified',
					elements: [
						{
							marks: ['ux-text-title'],
							// CSS selector, same as () => document.querySelectorAll('h1')
							elementSelector: 'h1',
						},
					],
				},
				{
					name: 'ux-primary-content-displayed',
					elements: [
						{
							marks: ['ux-text-intro'],
							elementSelector: '#intro',
						},
						{
							marks: ['ux-text-story'],
							elementSelector: '#story',
						},
						{
							marks: ['ux-image-onload-kitten', 'ux-image-inline-kitten'],
							elementSelector: 'img.cute',
						},
					],
				},
				{
					name: 'ux-primary-action-available',
					elements: [
						{
							marks: ['ux-text-story-details-link', 'ux-handler-moreclickable'],
							elementSelector: 'morelink',
							// number of elements to expect from elementSelectort
							// or a function returning boolean
							expectedElements: () => {
								document.querySelectorAll('#morelink').length > 0;
							},
						},
					],
				},
				{
					name: 'ux-secondary-content-displayed',
					elements: [
						{
							marks: ['ux-text-page2'],
							// function-based selector
							elementSelector: () => {
								document
									.querySelectorAll('a')
									.filter(element => element.href === 'page2.html');
							},
							expectedElements: 1,
						},
					],
				},
			]);
		</script>
	</head>

	<body>
		<h1>UX Capture library sample page</h1>
		<script>
			window.UXCapture.mark('ux-text-title');
		</script>

		<p id="intro">
			<img
				class="cute"
				src="kitten.jpg"
				style="float: left; margin: 0 1em 1em 0"
				width="30%"
				onload="window.UXCapture.mark('ux-image-onload-kitten')"
			/>
			<script>
				window.UXCapture.mark('ux-image-inline-kitten');
			</script>
			Decide to want nothing to do with my owner today. When in doubt, wash being
			gorgeous with belly side up sweet beast, but poop in the plant pot but munch on
			tasty moths. Brown cats with pink ears. Caticus cuteicus when in doubt, wash
			stare at ceiling, and scream at teh bath, lies down but cough hairball on
			conveniently placed pants claw your carpet in places everyone can see - why hide
			my amazing artistic clawing skills?. Meow in empty rooms.
		</p>
		<script>
			window.UXCapture.mark('ux-text-intro');
		</script>

		<script>
			// delaying this loop a tiny bit to show the difference
			var y = 0;

			for (var i = 0; i < 100000; i++) {
				y += i;
			}
		</script>

		<p id="story">
			Bacon ipsum dolor amet jowl swine brisket, drumstick pig chicken meatball ham
			hock ham salami andouille hamburger. Ribeye alcatra porchetta flank. Venison
			chicken meatloaf landjaeger. Porchetta burgdoggen ham hock, pork belly beef ribs
			chicken meatloaf jowl strip steak t-bone. Pork chop turducken drumstick kevin
			leberkas jowl chicken prosciutto salami meatloaf, tri-tip doner boudin ground
			round <a href="story-details.html" id="morelink">read more...</a>
			<script>
				window.UXCapture.mark('ux-text-story-details-link');
			</script>
		</p>
		<script>
			window.UXCapture.mark('ux-text-story');
		</script>

		<p>
			Suscipit anim. Fugit quaerat. Incididunt nesciunt. Cupidatat cillum sed. Laborum
			totam and dolores sit. Commodi eos yet laboris. Dolorem cillum, excepteur yet
			incididunt velit numquam. Ipsam error. Ratione consequuntur for magni ratione
			and incididunt sit. Esse inventore yet nostrud so nesciunt, eius. Ratione
			molestiae, autem, and dicta. Nostrud laboris labore, so nulla illum. Dolor totam
			inventore iure yet omnis ipsam incidunt. Eiusmod beatae or ipsam, dolore.
			Doloremque exercitationem. Error. Error modi. Ipsam ipsum or labore or ab
			aspernatur. Aliquip. Laudantium voluptas eaque for eius, yet laboris sed so
			dicta. Suscipit natus for eum veniam totam, for anim so fugiat. Suscipit
			explicabo and cillum or rem explicabo. Sint vel eiusmod labore, or dolor so
			nostrud for quae.
		</p>
		<p>
			Aliquid velit but odit error. Aute cupidatat or beatae. Voluptas in
			consequuntur. Incidunt vel, and consectetur. Numquam ipsa and est or dolorem so
			amet. Aliqua ea molestiae labore for eiusmod eu commodo. Est nequeporro so
			fugiat laborum laboriosam and nequeporro. Eu id yet irure so numquam yet
			exercitation. Fugit fugiat dicta for aliquip, and iure. Vel consequatur modi. Ut
			adipisicing yet nisi suscipit aute. Consequat esse laudantium. Amet cillum nisi
			so ipsam ad minima but dolore. Aperiam adipisci eum quo do. Sed ex and nisi quo
			quae quo for explicabo. Proident nesciunt for aliquid ratione. Occaecat
			consequat for enim quia eos quis, tempor. Lorem perspiciatis. Dolore eius
			consequatur error but minim. Pariatur cillum, ipsum explicabo but nemo. Aliquid
			molestiae so aliqua. Omnis commodo. Voluptas. Error proident, but lorem aperiam.
			Magnam quia laborum.
		</p>
		<p>
			Lorem non. Aperiam exercitationem omnis. Consequatur rem labore architecto. Ad
			molestiae explicabo but nemo for doloremque. Aliquip dolor, yet velitesse so
			omnis vitae aspernatur. Modi. Aliqua.
		</p>

		<a href="page2.html">Page 2 &gt; &gt;</a>
		<script>
			window.UXCapture.mark('ux-text-page2');
		</script>

		<script>
			// emulating a long-running JS event attachment, e.g. React re-hydration
			setTimeout(() => {
				document.getElementById('morelink').addEventListener('click', function(e) {
					e.preventDefault();

					alert('More kittens there');
				});

				window.UXCapture.mark('ux-handler-moreclickable');
			}, 300);
		</script>
	</body>
</html>
